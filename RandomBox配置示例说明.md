# 🎁 RandomBox 配置示例说明

## 📦 示例文件

`RandomBoxExample.yml` - 完整的原神式抽奖箱配置

---

## 🎯 配置特点

### 1. 传送带式动画
- 物品从右往左滚动
- 4阶段速度控制（快→中→慢→超慢）
- 总时长：7.5秒（150 ticks）
- 最终奖品停在中间位置

### 2. 原神式多层保底
```yaml
Pity:
  Uncommon:    # 3星保底
    Count: 5   # 5抽必出
  Rare:        # 4星保底
    Count: 10  # 10抽必出
  Legendary:   # 5星保底
    Count: 90  # 90抽必出
```

### 3. 五连抽支持
- **触发方式**：Shift + 右键点击箱子
- **要求**：至少5把钥匙（物理或虚拟）
- **效果**：快速抽取5次，无动画

---

## 🌟 奖品稀有度系统

### 2星（白色）- 基础奖励
- **权重**：25-35
- **概率**：约 60%
- **示例**：面包、熟牛肉、木制工具

### 3星（蓝色）- 5抽保底
- **权重**：15-20
- **概率**：约 30%
- **保底**：5抽必出
- **示例**：指南针、铁制工具、末影珍珠

### 4星（紫色）- 10抽保底
- **权重**：7-12
- **概率**：约 8%
- **保底**：10抽必出
- **示例**：紫水晶、钻石工具、钻石护甲

### 5星（金色）- 90抽保底
- **权重**：0.5-2
- **概率**：约 1%
- **保底**：90抽必出
- **示例**：下界之星、信标、下界合金套装

---

## 📊 保底机制详解

### 工作原理

```
玩家开箱
    ↓
增加所有稀有度的保底计数
    ↓
检查是否达到保底（从高到低）
    ↓
    ├─ 达到保底 → 从该稀有度奖品中随机选择
    │              ↓
    │          重置该稀有度的保底计数
    │              ↓
    │          发送保底触发通知
    │
    └─ 未达到保底 → 正常抽奖
                      ↓
                  抽到奖品
                      ↓
                  重置该稀有度及更低稀有度的保底计数
```

### 保底示例

**场景1：正常抽奖**
```
第1抽：2星  → 3星=1, 4星=1, 5星=1
第2抽：2星  → 3星=2, 4星=2, 5星=2
第3抽：3星  → 3星=0, 4星=0, 5星=3  (抽到3星，重置3星)
第4抽：2星  → 3星=1, 4星=1, 5星=4
第5抽：3星  → 3星=0, 4星=0, 5星=5  (触发3星保底)
```

**场景2：触发保底**
```
第1-4抽：全是2星
第5抽：触发3星保底 → 必出3星奖品
第6抽：重新开始计数
```

**场景3：五连抽**
```
五连抽前：3星=3, 4星=8, 5星=88
第1抽：2星 → 3星=4, 4星=9, 5星=89
第2抽：3星 → 3星=0, 4星=0, 5星=90 (触发3星保底)
第3抽：4星 → 3星=1, 4星=0, 5星=91 (触发4星保底)
第4抽：2星 → 3星=2, 4星=1, 5星=92
第5抽：5星 → 3星=0, 4星=0, 5星=0  (触发5星保底，重置所有)
```

---

## 🎮 使用方法

### 1. 放置箱子
```
/cc set RandomBox
```

### 2. 给予钥匙
```
/cc give physical RandomBox <玩家> 1
/cc give virtual RandomBox <玩家> 10
```

### 3. 开箱
- **单抽**：右键点击箱子
- **五连抽**：Shift + 右键点击箱子

### 4. 查看保底进度
使用 PlaceholderAPI 变量：
```
%crazycrates_RandomBox_pity_uncommon%   - 3星保底计数
%crazycrates_RandomBox_pity_rare%       - 4星保底计数
%crazycrates_RandomBox_pity_legendary%  - 5星保底计数
```

---

## 🎨 自定义配置

### 修改保底次数

```yaml
Pity:
  Rare:
    Count: 20  # 改成20抽保底
```

### 修改奖品稀有度

```yaml
Prizes:
  "1":
    Rarity: "rare"  # 改成4星奖品
    Weight: 10.0    # 调整权重
```

### 添加新奖品

```yaml
Prizes:
  "15":
    DisplayName: "<aqua>⭐⭐⭐⭐ 我的新奖品</aqua>"
    DisplayItem: "diamond"
    Rarity: "rare"
    Weight: 8.0
    Items:
      - "Item:diamond, Amount:10"
```

---

## 💡 配置技巧

### 1. 权重配置建议

| 稀有度 | 推荐权重 | 推荐数量 |
|--------|----------|----------|
| 2星 | 25-35 | 3-5个 |
| 3星 | 15-20 | 3-4个 |
| 4星 | 7-12 | 4-5个 |
| 5星 | 0.5-2 | 3-5个 |

### 2. 保底次数建议

| 服务器类型 | 3星 | 4星 | 5星 |
|-----------|-----|-----|-----|
| 休闲服 | 5 | 10 | 50 |
| 标准服 | 5 | 10 | 90 |
| 竞技服 | 10 | 20 | 180 |

### 3. 奖品价值建议

- **2星**：基础资源（面包、木头、石头）
- **3星**：进阶资源（铁锭、金锭、末影珍珠）
- **4星**：稀有物品（钻石工具、附魔书）
- **5星**：传说物品（下界之星、信标、下界合金）

---

## 🔍 常见问题

### Q1: 如何测试保底系统？
**A:** 使用命令给自己大量钥匙，然后连续开箱测试：
```
/cc give virtual RandomBox <你的名字> 100
```

### Q2: 保底计数在哪里存储？
**A:** 存储在 `data.yml` 文件中：
```yaml
Players:
  <UUID>:
    Pity:
      RandomBox:
        uncommon: 3
        rare: 8
        legendary: 45
```

### Q3: 如何重置玩家的保底计数？
**A:** 编辑 `data.yml` 文件，删除对应的保底数据，然后重载插件：
```
/cc reload
```

### Q4: 五连抽会触发保底吗？
**A:** 会！五连抽的每次抽取都会正确计算保底，可能在五连抽中触发保底。

### Q5: 可以设置更多层保底吗？
**A:** 可以！你可以添加任意数量的保底层级，例如：
```yaml
Pity:
  Common:
    Count: 3
  Uncommon:
    Count: 5
  Rare:
    Count: 10
  Epic:
    Count: 50
  Legendary:
    Count: 90
  Mythic:
    Count: 180
```

---

## 🎉 总结

RandomBox 配置示例提供了：

✅ **传送带式动画** - 视觉效果震撼  
✅ **原神式多层保底** - 公平的抽奖机制  
✅ **五连抽支持** - 快速抽奖体验  
✅ **完整的奖品系统** - 4个稀有度，14个奖品  
✅ **PlaceholderAPI** - 显示保底进度  
✅ **全服广播** - 5星奖品全服通知  
✅ **烟花效果** - 4星和5星奖品有烟花  

**立即使用这个配置，给你的玩家带来原神般的抽奖体验！**

---

**版本**: v5.0.14  
**日期**: 2026-02-04  
**配置文件**: `RandomBoxExample.yml`
